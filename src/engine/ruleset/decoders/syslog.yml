---
name: decoder/syslog/0

metadata:
  module: syslog
  title: Syslog Decoder event
  description: Syslog header
  compatibility: >
    This decoder has been tested on Wazuh version 4.3
  author:
    name: Wazuh, Inc.
    date: 2022/11/08
  references:
    - https://datatracker.ietf.org/doc/html/rfc3164
    - https://datatracker.ietf.org/doc/html/rfc5424

sources:
  - decoder/queue-syslog/0
  - decoder/queue-localfile/0

parse:
  logpar:
    # BSD Syslog RFC 3164 standard
    - event.original: "<event.start/SYSLOG> <host.hostname> <process.name>[<process.pid>]:<~/ignore/ ><message>"
    # BSD Syslog RFC 3164 no pid
    - event.original: "<event.start/SYSLOG> <host.hostname> <process.name>:<~/ignore/ ><message>"

    # BSD Syslog RFC 3164 standard ISO8601
    - event.original: "<event.start/ISO8601> <host.hostname> <process.name>[<process.pid>]: <message>"
    # BSD Syslog RFC 3164 no pid ISO8601
    - event.original: "<event.start/ISO8601> <host.hostname> <process.name>: <message>"
    - event.original: "<~event.month> <~event.day> <~event.year> <~event.time> <host.hostname> <process.name>[<process.pid>]: <message>"

normalize:
  - map:
      - event.kind: event
      - related.hosts: +a_append/$host.hostname
