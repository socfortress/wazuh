name: decoder/cisco/0

sources:
  - decoder/syslog/0

metadata:
  module: cisco
  compatibility: <= v7
  author:
    name: Wazuh Inc, info@wazuh.com
    date: "2022"
  references:
    - https://cisco.com
  title: Cisco Family main decoder.
  description: Decoder for common fields of Cisco Family products.

definitions:
  cisco: <~cisco.prefix>-<~cisco.sufix>-<event.severity>-%<cisco.message_id> <~local.message>
  cisco2: <~cisco.prefix>-<event.severity>-%<cisco.message_id> <~local.message>

check:
  - message: $cisco OR cisco2

parse:
  logpar:
    - message: $cisco1
    - message: $cisco2

normalize:
  - map:
      - event.module: cisco
      - event.code: $cisco.message_id

  # set default severity if there is none yet
  - check:
      - event.severity: +t_is_null
    map:
      - event.severity: 7
  # set log.level
  - check:
      - event.severity: +i_eq/0
    map:
      - log.level: unkown
  - check:
      - event.severity: +i_eq/1
    map:
      - log.level: alert
  - check:
      - event.severity: +i_eq/2
    map:
      - log.level: critical
  - check:
      - event.severity: +i_eq/3
    map:
      - log.level: error
  - check:
      - event.severity: +i_eq/4
    map:
      - log.level: warning
  - check:
      - event.severity: +i_eq/5
    map:
      - log.level: notification
  - check:
      - event.severity: +i_eq/6
    map:
      - log.level: informational
  - check:
      - event.severity: +i_eq/7
    map:
      - log.level: debug
